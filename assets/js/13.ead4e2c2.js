(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{568:function(s,a,e){"use strict";e.r(a);var t=e(4),r=Object(t.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("blockquote",[e("p",[s._v("注意："),e("br"),s._v("\n我们以正常模式在centOs镜像中安装NGINX后，需要访问docker容器内部PHP项目配置")])]),s._v(" "),e("h3",{attrs:{id:"docker搜索php-fpm"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker搜索php-fpm"}},[s._v("#")]),s._v(" docker搜索PHP-fpm")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker search php-fpm\n")])])]),e("h3",{attrs:{id:"docker下载php-fpm容器镜像"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker下载php-fpm容器镜像"}},[s._v("#")]),s._v(" docker下载php-fpm容器镜像")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker pull php-fpm\n")])])]),e("h3",{attrs:{id:"查询docker中运行镜像文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查询docker中运行镜像文件"}},[s._v("#")]),s._v(" 查询docker中运行镜像文件")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker images "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" php-fpm\n")])])]),e("h3",{attrs:{id:"安装docker容器php-fpm"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装docker容器php-fpm"}},[s._v("#")]),s._v(" 安装docker容器php-fpm")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker run -privileged"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\n-p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("9000")]),s._v(":9000\n--name php729-fpm \n-v /var/www:/var/www \n-v /user/local/php/conf:/usr/local/etc/php \n-v /usr/local/php/conf/conf.d:/usr/local/etc/php/conf.d \n-v /usr/local/php/logs:/phplogs \n--restart"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always \n-itd \n php729-fpm:latest \n")])])]),e("h3",{attrs:{id:"查看php-fpm容器ip地址"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查看php-fpm容器ip地址"}},[s._v("#")]),s._v(" 查看php-fpm容器IP地址")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker inspect php729-fpm "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" IPAddress\n")])])]),e("p",[e("img",{attrs:{src:"/assets/img/docker/2.png",alt:"Image text"}}),e("br")]),s._v(" "),e("h3",{attrs:{id:"配置centos中nginx配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置centos中nginx配置"}},[s._v("#")]),s._v(" 配置centOs中NGINX配置")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("server {\n    listen 80;\n    server_name oa.api.test.cn;\n    rewrite ^(.*)$ https://${server_name}$1 permanent;\n}\nserver {\n    listen 443;\n    server_name oa.api.test.cn;\n    ssl on;\n    ssl_certificate   /home/ssl/3324583_oa.api.test.cn.pem;\n    ssl_certificate_key  /home/ssl/3324583_oa.api.test.cn.key;\n    #ssl_client_certificate /home/ssl/ca.crt;\n    #ssl_verify_client on;\n    ssl_session_timeout 5m;\n    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;\n    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n    ssl_prefer_server_ciphers on;\n    root /var/www/dingding/public;\n    index index.html index.php;\n\n    location / {\n        try_files $uri $uri/ /index.php?$query_string;\n    }\n\n    location ~\\.php$ {\n        #fastcgi_pass   unix:/tmp/php-cgi.sock;\n        fastcgi_pass 172.17.0.5:9000;\n        #fastcgi_index  /var/www/wechat/public/index.php;\n        fastcgi_index  index.php;\n        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n        fastcgi_param  REMOTE_ADDR        $remote_addr;\n        fastcgi_param HTTP_X_FORWARDED_FOR $proxy_add_x_forwarded_for;\n        include        fastcgi_params;\n    }\n    location ~ MP_verify_(.*)\\.txt?$ {\n        return 200 $1;\n    }\n}\n")])])]),e("p",[e("img",{attrs:{src:"/assets/img/docker/3.png",alt:"Image text"}}),e("br")]),s._v(" "),e("blockquote",[e("p",[s._v("注意：\n因容器内部文件的访问权限和容器外的访问权限可能不一致"),e("code",[s._v("用户/用户组")]),s._v("不是同一个用户组,通过查看/etc/passwd查看。")])]),s._v(" "),e("ol",[e("li",[s._v("查询容器内/var/www内容器的所有者权限\n"),e("img",{attrs:{src:"/assets/img/docker/4.png",alt:"Image text"}}),e("br")]),s._v(" "),e("li",[s._v("查看容器外，服务器中 /var/www容器内所有者权限\n"),e("img",{attrs:{src:"/assets/img/docker/5.png",alt:"Image text"}}),e("br"),s._v("\n保证这两个权限一致。才能成功访问到PHP文件")])]),s._v(" "),e("p",[s._v("docker 中安装PHP拓展"),e("br"),s._v(" "),e("img",{attrs:{src:"/assets/img/docker/6.png",alt:"Image text"}}),e("br")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v(" /usr/local/bin/docker-php-ext-enable gd mysqli\n docker-php-ext-enable  pdo pdo_mysql\n")])])]),e("h3",{attrs:{id:"可能点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#可能点"}},[s._v("#")]),s._v(" 可能点")]),s._v(" "),e("p",[e("img",{attrs:{src:"/assets/img/docker/7.png",alt:"Image text"}}),e("br")])])}),[],!1,null,null,null);a.default=r.exports}}]);