---
title: 查询时间最大的一条记录
date: 2020-04-17
author: NeJuly
tags:
  - Mysql
location: 重庆
---
> 初学时对于查询最大一条数据记录会有一定误解，例子如下：
```mysql
 SELECT ip,MAX(act_time) FROM users_login GROUP BY login_id;
```
以上 sql 语句只是简单的查询了`login_id`的最大时间，从根本上并没有解决问题。
但是这样是取不出用户登录记录中时间最大的那个 ip , 仅仅只是查到了最大时间,和 ip 没关系
找了相当多的文章，经过自己测试，发现一个比较好的方式处理这个问题，举例如下：
现在假设有一张数据表 A , 字段和数据如下：

姓名(name) |身份证(唯一标识)(id) |购买产品(pro) |价格(price) |数量(count) |购买时间(time)
--|--|--|--|--|--|
张1 |111111| Computer| 1600| 5 |2018-03-03
张1 |11111 |Phone| 12　　|　　 12　|　 2018-03-05
张2 |22222 |Pipe| 1| 234 |2018-03-04
张2 |22222 |Computer| 1600| 5 |2018-03-05
张3 |33333 |Phone| 12 |12 |2018-03-03
张3 |33333 |Pipe| 1| 234 |2018-03-06
张3 |33333 |Computer |1600　|　 5 |2018-03-09
张4 |44444 |Phone |12| 12| 2018-03-09
张5 |55555 |Pipe| 1 |234| 2018-03-02

在这张数据表中，我们需要查询表中每一个用户在最后一次都购买了什么产品以及相关信息
SQL语句如下：
```mysql
SELECT * from (SELECT * FROM A ORDER BY time) a GROUP BY a.id;
```
>解释：
>
>先通过时间排序倒序排序，外层通过`aid`进行分组，因为有MySQL的机制，默认分组获取的是最新的一条数据（第一条数据）。
